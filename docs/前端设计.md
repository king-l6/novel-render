# 前端设计规范

本文档为「前端设计」相关问题的技能文档。当用户问题包含**前端、设计、UI、页面、样式、界面**等字眼时，回答与实现必须遵循本规范。

---

## 技术栈

- **框架**：Vue 3（Composition API）
- **语言**：TypeScript
- **构建工具**：Vite
- **CSS 框架**：**Tailwind CSS**（优先使用）
- **UI 组件库**：**Ant Design Vue (antdvue)**（优先使用）
- **状态管理**：**Pinia**（必须使用）
- **路由**：Vue Router

## Vue 3 Composition API 最佳实践

### 核心 API 使用

- ✅ **组件逻辑**：使用 `setup()` 函数组织组件逻辑
- ✅ **响应式状态**：
  - 基本类型用 `ref()`：`const count = ref(0)`
  - 对象/数组用 `reactive()`：`const state = reactive({ name: 'Vue' })`
- ✅ **计算属性**：使用 `computed()` 实现派生状态
  ```typescript
  const doubleCount = computed(() => count.value * 2)
  ```
- ✅ **副作用**：
  - `watch()`：监听特定数据源变化
  - `watchEffect()`：自动追踪依赖的响应式数据
- ✅ **生命周期**：使用组合式 API 生命周期钩子
  - `onMounted()`、`onUpdated()`、`onUnmounted()`、`onBeforeMount()` 等
- ✅ **依赖注入**：使用 `provide()` / `inject()` 实现跨层级组件通信

### 项目结构

```
src/
  components/     # 可复用组件（.vue 文件）
  hooks/          # 组合式函数（Hooks，可复用的逻辑）
  views/          # 页面视图组件
  router/         # Vue Router 路由配置
  store/          # Pinia 状态管理
    modules/      # 按功能模块划分的 store
  assets/         # 静态资源（图片、字体等）
  App.vue         # 根组件
  main.ts         # 入口文件
```

### 开发要求

1. **TypeScript**：
   - 所有 `.vue` 文件使用 `<script setup lang="ts">`
   - 定义明确的类型接口和类型注解
   - Props 和 Emits 必须定义类型

2. **Props & Emits**：
   ```typescript
   // Props 定义
   interface Props {
     title: string
     count?: number
   }
   const props = withDefaults(defineProps<Props>(), {
     count: 0
   })
   
   // Emits 定义
   const emit = defineEmits<{
     (e: 'update', value: string): void
     (e: 'delete'): void
   }>()
   ```

3. **Teleport**：需要将组件渲染到 DOM 树外时使用（如 Modal、Toast）
   ```vue
   <Teleport to="body">
     <Modal />
   </Teleport>
   ```

4. **Suspense**：异步组件使用 Suspense 处理加载和错误状态
   ```vue
   <Suspense>
     <template #default>
       <AsyncComponent />
     </template>
     <template #fallback>
       <Loading />
     </template>
   </Suspense>
   ```

5. **错误处理**：
   - 使用 `onErrorCaptured()` 捕获子组件错误
   - API 请求使用 try-catch 处理异常
   - 提供用户友好的错误提示

6. **代码规范**：
   - 遵循 [Vue 3 官方风格指南](https://cn.vuejs.org/style-guide/)
   - 组件名使用 PascalCase（如 `UserProfile.vue`）
   - Hooks 函数名使用 camelCase，以 `use` 开头（如 `useUserData.ts`），放在 `hooks/` 目录
   - Props 名使用 camelCase，模板中使用 kebab-case

7. **构建工具**：
   - 使用 Vite 进行开发和构建
   - 配置路径别名（如 `@/components`）
   - 优化生产构建配置

## CSS 样式规范（Tailwind CSS 优先）

### 核心原则

- ✅ **优先使用 Tailwind CSS**：所有样式尽量通过 Tailwind 工具类实现
- ✅ **工具类优先**：使用 `class="flex items-center justify-between p-4 bg-white rounded-lg shadow-md"` 而非手写 CSS
- ✅ **响应式设计**：使用 Tailwind 响应式前缀（`sm:`、`md:`、`lg:`、`xl:`、`2xl:`）
- ✅ **自定义样式**：仅在 Tailwind 无法满足时（复杂动画、特殊效果）才使用自定义 CSS
- ✅ **作用域**：自定义样式放在 `<style scoped>` 中，避免全局污染
- ❌ **避免独立 CSS 文件**：除非是全局样式或 Tailwind 配置文件

### Tailwind 使用示例

```vue
<template>
  <!-- 使用 Tailwind 工具类 -->
  <div class="container mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-md p-6 mb-4">
      <h2 class="text-2xl font-bold text-gray-800 mb-4">标题</h2>
      <button class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors">
        按钮
      </button>
    </div>
  </div>
</template>
```

### 自定义样式（仅在必要时）

```vue
<style scoped>
/* 仅在 Tailwind 无法实现时使用 */
.custom-animation {
  animation: customSpin 2s linear infinite;
}

@keyframes customSpin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}
</style>
```

## UI 组件库规范（Ant Design Vue）

### 核心原则

- ✅ **优先使用 Ant Design Vue 组件**：表单、表格、按钮、输入框、弹窗等使用 antdvue 组件
- ✅ **按需导入**：使用 Tree Shaking，只导入需要的组件
- ✅ **配合 Tailwind CSS**：Ant Design Vue 组件可通过 `class` 属性配合 Tailwind 进行样式定制
- ✅ **遵循组件 API**：严格按照 Ant Design Vue 官方文档使用组件和属性

### 组件导入方式

```typescript
// 按需导入（推荐）
import { Button, Table, Form, Input, Modal, message, Card, Select, Checkbox, Alert, Spin } from 'ant-design-vue'
import type { TableColumnsType } from 'ant-design-vue'

// 或全局注册（在 main.ts 中）
import { createApp } from 'vue'
import Antd from 'ant-design-vue'
import 'ant-design-vue/dist/reset.css'
const app = createApp(App)
app.use(Antd)
```

### 组件使用规范（重要）

- ✅ **必须使用导入的组件名**：在模板中使用导入的组件名（如 `Table`、`Button`），而不是 `a-table`、`a-button`
- ✅ **按需导入**：只导入使用的组件，避免全量导入
- ✅ **组件注册**：在 `<script setup>` 中导入后，组件会自动注册，可直接在模板中使用
- ✅ **即使全局注册也要导入**：即使 `main.ts` 中全局注册了 Ant Design Vue，组件文件中仍需导入使用的组件，并在模板中使用导入的组件名（如 `<Table>` 而不是 `<a-table>`）

### 使用示例

```vue
<template>
  <div class="p-4">
    <!-- 使用导入的组件名：Button、Table、Form 等 -->
    <Button 
      type="primary" 
      class="mb-4 hover:shadow-lg transition-shadow"
      @click="handleClick"
    >
      提交
    </Button>
    
    <Table 
      :columns="columns" 
      :data-source="dataSource"
      :pagination="{ pageSize: 10 }"
      class="rounded-lg"
    />
    
    <Form 
      :model="formData"
      :rules="rules"
      layout="vertical"
      class="mt-4"
    >
      <FormItem label="用户名" name="username">
        <Input v-model:value="formData.username" />
      </FormItem>
    </Form>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { Button, Table, Form, FormItem, Input } from 'ant-design-vue'
import type { TableColumnsType } from 'ant-design-vue'

const formData = ref({ username: '' })
const columns: TableColumnsType = [
  { title: '姓名', dataIndex: 'name', key: 'name' },
  { title: '年龄', dataIndex: 'age', key: 'age' }
]
</script>
```

### 组件命名对照表

| 导入的组件名 | ❌ 错误用法（a-前缀） | ✅ 正确用法 |
|------------|---------------------|-----------|
| `Table` | `<a-table>` | `<Table>` |
| `Button` | `<a-button>` | `<Button>` |
| `Form` | `<a-form>` | `<Form>` |
| `FormItem` | `<a-form-item>` | `<FormItem>` |
| `Input` | `<a-input>` | `<Input>` |
| `Select` | `<a-select>` | `<Select>` |
| `Card` | `<a-card>` | `<Card>` |
| `Checkbox` | `<a-checkbox>` | `<Checkbox>` |
| `Alert` | `<a-alert>` | `<Alert>` |
| `Spin` | `<a-spin>` | `<Spin>` |
| `Modal` | `<a-modal>` | `<Modal>` |
| `message` | `a-message` | `message`（函数调用） |

### 常用组件

- **表单**：`a-form`、`a-form-item`、`a-input`、`a-select`、`a-date-picker` 等
- **数据展示**：`a-table`、`a-list`、`a-card`、`a-descriptions` 等
- **反馈**：`a-modal`、`a-message`、`a-notification`、`a-popconfirm` 等
- **导航**：`a-menu`、`a-breadcrumb`、`a-tabs`、`a-pagination` 等
- **布局**：`a-layout`、`a-row`、`a-col`、`a-space` 等

### 样式定制

- **使用 Tailwind CSS**：通过 `class` 属性添加 Tailwind 工具类
- **主题定制**：如需全局主题定制，配置 Ant Design Vue 的主题变量
- **组件样式覆盖**：优先使用 Tailwind，必要时使用深度选择器（`:deep()`）

## 视觉与布局

- **主色**：使用 Ant Design Vue 的主题色，或通过 Tailwind 颜色系统定制
- **字体**：Ant Design Vue 默认字体，或使用 Tailwind 字体工具类
- **布局**：使用 Ant Design Vue 的 `a-layout`、`a-row`、`a-col` 或 Tailwind 布局工具类
- **间距**：使用 Ant Design Vue 的 `a-space` 组件或 Tailwind 的 `gap-*`、`p-*`、`m-*` 工具类

## 组件开发规范

- **单文件组件**：每个组件一个 `.vue` 文件
- **Hooks 函数**：可复用逻辑提取到 `hooks/` 目录，文件名以 `use` 开头（如 `useUserData.ts`、`useTable.ts`）
- **组件命名**：PascalCase，语义清晰
- **Props 验证**：使用 TypeScript 类型定义，必要时添加运行时验证
- **UI 组件选择**：
  - ✅ 优先使用 Ant Design Vue 组件（表单、表格、按钮、弹窗等）
  - ✅ 复杂业务组件可基于 Ant Design Vue 组件封装
  - ✅ 简单展示组件可直接用 Tailwind CSS 实现

### Hooks 使用示例

```typescript
// src/hooks/useUserData.ts
import { ref, computed } from 'vue'
import { getUserInfo } from '@/api/user'

export function useUserData() {
  const userInfo = ref<UserInfo | null>(null)
  const loading = ref(false)
  
  const userName = computed(() => userInfo.value?.name || '')
  
  async function fetchUserInfo() {
    loading.value = true
    try {
      userInfo.value = await getUserInfo()
    } finally {
      loading.value = false
    }
  }
  
  return {
    userInfo,
    loading,
    userName,
    fetchUserInfo
  }
}
```

```vue
<!-- 在组件中使用 -->
<script setup lang="ts">
import { useUserData } from '@/hooks/useUserData'
import { onMounted } from 'vue'

const { userInfo, loading, userName, fetchUserInfo } = useUserData()

onMounted(() => {
  fetchUserInfo()
})
</script>
```

## 交互与可访问性

- 重要操作需有明确反馈（加载中、成功/失败提示）
- 表单校验：使用 Hooks 函数封装校验逻辑（放在 `hooks/` 目录）
- 避免仅靠颜色传达信息，配合文字或图标
- 支持键盘导航和屏幕阅读器

## 状态管理规范（Pinia）

### 核心原则

- ✅ **使用 Pinia**：全局状态管理必须使用 Pinia，不使用 Vuex
- ✅ **Setup API 风格**：优先使用 Setup API 风格（`defineStore(id, () => { ... })`），与 Composition API 保持一致
- ✅ **模块化**：按功能模块划分 store，每个模块一个文件
- ✅ **TypeScript**：使用 TypeScript 定义 store 的类型

### Store 定义方式

```typescript
// src/store/user.ts - Setup API 风格（推荐）
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'

export const useUserStore = defineStore('user', () => {
  // State
  const userInfo = ref<UserInfo | null>(null)
  const token = ref<string>('')
  
  // Getters
  const isLoggedIn = computed(() => !!token.value)
  const userName = computed(() => userInfo.value?.name || '')
  
  // Actions
  function setUserInfo(info: UserInfo) {
    userInfo.value = info
  }
  
  function setToken(newToken: string) {
    token.value = newToken
  }
  
  async function login(username: string, password: string) {
    // API 调用
    const response = await api.login({ username, password })
    setToken(response.token)
    setUserInfo(response.userInfo)
  }
  
  function logout() {
    userInfo.value = null
    token.value = ''
  }
  
  return {
    // State
    userInfo,
    token,
    // Getters
    isLoggedIn,
    userName,
    // Actions
    setUserInfo,
    setToken,
    login,
    logout
  }
})
```

### 在组件中使用 Store

```vue
<template>
  <div>
    <p v-if="userStore.isLoggedIn">
      欢迎，{{ userStore.userName }}
    </p>
    <a-button @click="handleLogin">登录</a-button>
    <a-button @click="handleLogout">退出</a-button>
  </div>
</template>

<script setup lang="ts">
import { useUserStore } from '@/store/user'

const userStore = useUserStore()

const handleLogin = async () => {
  await userStore.login('username', 'password')
}

const handleLogout = () => {
  userStore.logout()
}
</script>
```

### Store 结构规范

```
src/store/
  index.ts          # Pinia 实例创建和导出
  modules/
    user.ts         # 用户相关状态
    app.ts          # 应用全局状态（主题、语言等）
    permission.ts   # 权限相关状态
```

### 最佳实践

1. **Store 命名**：使用 `use` 前缀（如 `useUserStore`、`useAppStore`）
2. **State 初始化**：使用 `ref()` 定义响应式状态
3. **Getters**：使用 `computed()` 定义计算属性
4. **Actions**：异步操作放在 actions 中，可调用 API
5. **Store 组合**：一个 store 可以调用另一个 store
6. **持久化**：如需持久化，使用 `pinia-plugin-persistedstate`

### Store 组合示例

```typescript
// src/store/app.ts
import { defineStore } from 'pinia'
import { ref } from 'vue'

export const useAppStore = defineStore('app', () => {
  const theme = ref<'light' | 'dark'>('light')
  const language = ref<'zh' | 'en'>('zh')
  
  function toggleTheme() {
    theme.value = theme.value === 'light' ? 'dark' : 'light'
  }
  
  return { theme, language, toggleTheme }
})

// src/store/user.ts - 可以调用其他 store
import { useAppStore } from './app'

export const useUserStore = defineStore('user', () => {
  const appStore = useAppStore()
  
  function login() {
    // ... 登录逻辑
    // 可以访问其他 store
    console.log(appStore.theme)
  }
  
  return { login }
})
```

## 与后端的配合

- API 请求：使用 `axios` 或 `fetch`，封装统一的请求函数
- 错误处理：统一处理 HTTP 错误和业务错误
- 类型定义：后端接口返回的数据类型应在 TypeScript 中定义
- **状态同步**：API 返回的数据应更新到 Pinia store 中，组件通过 store 访问数据

---

*可在本文件中继续补充：设计稿说明、组件库约定、动效规范、具体业务场景等。*
